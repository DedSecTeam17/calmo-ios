name: Run Fastlane Unit Tests

on:
  pull_request:
    branches:
      - develop

jobs:
  test:
    runs-on: macos-13

    steps:
    - name: Checkout Code
      uses: actions/checkout@v2
      

    - name: XCODE VERSION 
      run: xcodebuild -version

    - name: install pods
      run: pod install

    - name: List Available Simulators
      run: xcrun simctl list devices 
      

    - name: BOOT iphone 14
      run:  xcrun simctl boot "iPhone 14"

    - name : BOOT iPhone SE
      run: xcrun simctl boot "iPhone SE (3rd generation)"


    - name: List Available Simulators
      run: xcrun simctl list devices 


    - name: Set up Ruby
      uses: ruby/setup-ruby@v1
      with:
        ruby-version: 2.7.2 # You can specify the Ruby version you need

    - name: Install Bundler and Fastlane
      run: |
        gem install bundler
        bundle install --without=documentation --path vendor/bundle

    - name: Run Fastlane Unit Tests
      run: |
        bundle exec fastlane tests_unit # Make sure to define the "tests" lane in your Fastfile

    - name: Run Fastlane UI Tests
      run: |
        bundle exec fastlane tests_ui # Make sure to define the "tests" lane in your Fastfile